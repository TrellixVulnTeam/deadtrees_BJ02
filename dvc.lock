schema: '2.0'
stages:
  createtiles:
    cmd: mkdir data/processed; gdal_retile.py  -csv locations.csv  -v -ps 8192 8192
      -co "TILED=YES" -co "COMPRESS=LZW"  -targetDir data/processed  data/raw/tif_ortho_2019.tif
    deps:
    - path: data/raw/tif_ortho_2019.tif
      md5: f29b9345665f25e7465eafa3bd6f2f49
      size: 353002145755
    params:
      params.yaml:
        source_dim: 8192
    outs:
    - path: data/processed
      md5: 47072b35402c0e5113b1c912a47c7bc8.dir
      size: 169238409104
      nfiles: 1839
  createmasks:
    cmd: python createmasks.py data/processed data/processed.masks data/raw/dead_treed_proj.shp
    deps:
    - path: data/processed
      md5: 47072b35402c0e5113b1c912a47c7bc8.dir
      size: 169238409104
      nfiles: 1839
    - path: data/raw/dead_treed_proj.dbf
      md5: bdd8cf66420982fa5732ce0123ba52dc
      size: 162512
    - path: data/raw/dead_treed_proj.prj
      md5: 800897f6385d09a99ee62978930f07fe
      size: 436
    - path: data/raw/dead_treed_proj.shp
      md5: 2389ce8034d1c6f3955ecf7bd4b5f109
      size: 2160036
    - path: data/raw/dead_treed_proj.shx
      md5: f2e5b8e7338cf8848fa4518c9b65a595
      size: 61972
    outs:
    - path: data/processed.masks
      md5: f39a35312f6231103bdb82c2090882ee.dir
      size: 5973460259
      nfiles: 89
  createdataset:
    cmd: python createdataset.py data/processed data/processed.masks data/dataset  --source_dim
      8192 --tile_size 512 --format PNG
    deps:
    - path: data/processed
      md5: 47072b35402c0e5113b1c912a47c7bc8.dir
      size: 169238409104
      nfiles: 1839
    - path: data/processed.masks
      md5: f39a35312f6231103bdb82c2090882ee.dir
      size: 5973460259
      nfiles: 89
    params:
      params.yaml:
        createdataset.tile_size: 512
        file_type: PNG
        source_dim: 8192
    outs:
    - path: data/dataset/stats.csv
      md5: acb924c4d740c9c0c1c9c2e9fa3de8c6
      size: 626450
    - path: data/dataset/train
      md5: 731c1ee66a14bf5df76c9cb4affaeb1b.dir
      size: 8440494080
      nfiles: 22
  createbalanced:
    cmd: python createbalanced.py  data/dataset/stats.csv data/dataset/train  data/dataset/train_balanced  data/dataset/train_balanced_short
      --format PNG
    deps:
    - path: data/dataset/train
      md5: 731c1ee66a14bf5df76c9cb4affaeb1b.dir
      size: 8440494080
      nfiles: 22
    params:
      params.yaml:
        file_type: PNG
    outs:
    - path: data/dataset/train_balanced
      md5: 461ef3d0701db0d9314ab1e794914bbb.dir
      size: 8434124800
      nfiles: 42
    - path: data/dataset/train_balanced_short
      md5: dfffb26b86800bc4fefc9820e2a718f5.dir
      size: 1113671680
      nfiles: 20
